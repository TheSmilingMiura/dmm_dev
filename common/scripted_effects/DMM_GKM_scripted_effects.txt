#oh yeah its big brain time
GKM_add_influence = {
	for_loop_effect = {
		start = 0
		end = GKM_influence_array^num

		add_to_temp_array = { temp_GKM_influence_array = v }
	}

	remove_from_temp_array = { temp_GKM_influence_array = temp_industry }
	add_to_variable = { GKM_influence_array^temp_industry = temp_value_added }

	while_loop_effect = {
		limit = { check_variable = { temp_value_added > 0 } }

		for_loop_effect = {
			start = 0
			end = temp_GKM_influence_array^num

			if = {
				limit = {
					check_variable = { GKM_influence_array^temp_GKM_influence_array^v > 0 }
					check_variable = { temp_value_added > 0 }
				}
				subtract_from_variable = { GKM_influence_array^temp_GKM_influence_array^v = 1 }
				subtract_from_temp_variable = { temp_value_added = 1 }
			}
		}
	}
}

GKM_check_influence = {
	if = {
		limit = {
			aerospace_industry_dominant = yes
		}
		if = {
			limit = {
				has_idea = GKM_defense_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_defense_industry_dominant_idea
				add_idea = GKM_aerospace_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_heavy_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_heavy_industry_dominant_idea
				add_idea = GKM_aerospace_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_consumer_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_consumer_industry_dominant_idea
				add_idea = GKM_aerospace_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				NOT = { has_idea = GKM_aerospace_industry_dominant_idea }
			}
			add_ideas = GKM_aerospace_industry_dominant_idea
		}
	}
	else_if = {
		limit = {
			defense_industry_dominant = yes
		}
		if = {
			limit = {
				has_idea = GKM_aerospace_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_aerospace_industry_dominant_idea
				add_idea = GKM_defense_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_heavy_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_heavy_industry_dominant_idea
				add_idea = GKM_defense_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_consumer_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_consumer_industry_dominant_idea
				add_idea = GKM_defense_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				NOT = { has_idea = GKM_defense_industry_dominant_idea }
			}
			add_ideas = GKM_defense_industry_dominant_idea
		}
	}
	else_if = {
		limit = {
			heavy_industry_dominant = yes
		}
		if = {
			limit = {
				has_idea = GKM_aerospace_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_aerospace_industry_dominant_idea
				add_idea = GKM_heavy_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_defense_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_defense_industry_dominant_idea
				add_idea = GKM_heavy_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_consumer_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_consumer_industry_dominant_idea
				add_idea = GKM_heavy_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				NOT = { has_idea = GKM_heavy_industry_dominant_idea }
			}
			add_ideas = GKM_heavy_industry_dominant_idea
		}
	}
	else_if = {
		limit = {
			consumer_industry_dominant = yes
		}
		if = {
			limit = {
				has_idea = GKM_aerospace_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_aerospace_industry_dominant_idea
				add_idea = GKM_consumer_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_defense_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_defense_industry_dominant_idea
				add_idea = GKM_consumer_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				has_idea = GKM_heavy_industry_dominant_idea
			}
			swap_ideas = {
				remove_idea = GKM_heavy_industry_dominant_idea
				add_idea = GKM_consumer_industry_dominant_idea
			}
		}
		else_if = {
			limit = {
				NOT = { has_idea = GKM_consumer_industry_dominant_idea }
			}
			add_ideas = GKM_consumer_industry_dominant_idea
		}
	}
	else = {
		if = {
			limit = {
				has_idea = GKM_aerospace_industry_dominant_idea
			}
			add_ideas = GKM_aerospace_industry_dominant_idea
		}
		else_if = {
			limit = {
				has_idea = GKM_defense_industry_dominant_idea
			}
			remove_ideas = GKM_defense_industry_dominant_idea
		}
		else_if = {
			limit = {
				has_idea = GKM_heavy_industry_dominant_idea
			}
			remove_ideas = GKM_heavy_industry_dominant_idea
		}
		else_if = {
			limit = {
				has_idea = GKM_consumer_industry_dominant_idea
			}
			remove_ideas = GKM_consumer_industry_dominant_idea
		}
	}
}
